<!DOCTYPE html>
<html>
<head>
  <title>360 панорама</title>
  <style>html,body{margin:0;height:100%;overflow:hidden;}#viewer{width:100%;height:100%;}</style>
</head>
<body>
<div id="viewer"></div>

<!-- ТВОЙ файл three.min.js -->
<script src="./three.min.js"></script>
<script>
if (typeof THREE === 'undefined') {
  document.body.innerHTML = '<h1 style="color:red;padding:50px;">❌ three.min.js не загрузился!<br>Убедись, что файл лежит рядом с index.html</h1>';
} else {
  console.log('✅ THREE загружен!');
  
  const container = document.getElementById('viewer');
  const scene = new THREE.Scene();
  const camera = new THREE.PerspectiveCamera(75, container.clientWidth/container.clientHeight, 1, 1100);
  const renderer = new THREE.WebGLRenderer();
  renderer.setSize(container.clientWidth, container.clientHeight);
  container.appendChild(renderer.domElement);

  const geometry = new THREE.SphereGeometry(500, 60, 40);
  geometry.scale(-1, 1, 1);
  
  const loader = new THREE.TextureLoader();
  loader.load(
    './IMG_20181020_183652_00_012.jpg',
    texture => {
      console.log('✅ Фото загружено!');
      const material = new THREE.MeshBasicMaterial({map: texture});
      const mesh = new THREE.Mesh(geometry, material);
      scene.add(mesh);
      animate();
    },
    undefined,
    error => {
      console.error('❌ Ошибка фото:', error);
      document.body.innerHTML = '<h1 style="color:orange;padding:50px;">❌ Фото не найдено:<br>IMG_20181020_183652_00_012.jpg</h1>';
    }
  );

  let lon = 0, lat = 0, isDragging = false, prevX = 0, prevY = 0;

  container.addEventListener('mousedown', e => {
    isDragging = true;
    prevX = e.clientX;
    prevY = e.clientY;
  });

  container.addEventListener('mousemove', e => {
    if (!isDragging) return;
    lon += (prevX - e.clientX) * 0.005;
    lat += (e.clientY - prevY) * 0.005;
    lat = Math.max(-85, Math.min(85, lat));
    prevX = e.clientX;
    prevY = e.clientY;
  });

  container.addEventListener('mouseup', () => isDragging = false);

  function animate() {
    requestAnimationFrame(animate);
    lon += 0.0003;
    const phi = THREE.MathUtils.degToRad(90 - lat);
    const theta = THREE.MathUtils.degToRad(lon);
    camera.position.x = 500 * Math.sin(phi) * Math.cos(theta);
    camera.position.y = 500 * Math.cos(phi);
    camera.position.z = 500 * Math.sin(phi) * Math.sin(theta);
    camera.lookAt(scene.position);
    renderer.render(scene, camera);
  }
}
</script>
</body>
</html>
